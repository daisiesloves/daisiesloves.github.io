<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Keepalived高可用IPVS健康状态检测]]></title>
    <url>%2F2018%2F12%2F24%2FKeepalived%E9%AB%98%E5%8F%AF%E7%94%A8IPVS%E5%81%A5%E5%BA%B7%E7%8A%B6%E6%80%81%E6%A3%80%E6%B5%8B%2F</url>
    <content type="text"><![CDATA[测试环境 nodesrv1: 192.168.6.86, nodesrv2: 192.168.6.88 realsrv1: 192.168.6.80, realsrv2: 192.168.6.82 cleint: 192.168.6.68 vip: 192.168.6.99 1.nodesrv端安装及配置 nodesrv[1,2] yum install keepalived -y yum install ipvsadm -y 2.nodesrv1配置文件,nodesrv2修改对应IP地址 vi /etc/keepalived/keepalived.conf ! Configuration File for keepalived global_defs { notification_email { root@localhost } notification_email_from keepalived@localhost smtp_server 127.0.0.1 smtp_connect_timeout 30 router_id nodesrv1 vrrp_mcast_group4 224.0.100.89 vrrp_skip_check_adv_addr vrrp_strict vrrp_garp_interval 0 vrrp_gna_interval 0 } vrrp_instance VI_1 { state MASTER interface ens33 virtual_router_id 16 priority 100 advert_int 1 authentication { auth_type PASS auth_pass 516f97b2 } virtual_ipaddress { 192.168.6.99/24 dev ens33 } track_interface { ens33 } notify_master &quot;/etc/keepalived/notify.sh master&quot; notify_backup &quot;/etc/keepalived/notify.sh backup&quot; notify_fault &quot;/etc/keepalived/notify.sh fault&quot; } vrrp_instance VI_2 { state BACKUP interface ens33 virtual_router_id 26 priority 98 advert_int 1 authentication { auth_type PASS auth_pass 0uuOpPPp } virtual_ipaddress { 192.168.6.98/24 dev ens33 } } virtual_server 192.168.6.99 80 { delay_loop 2 lb_algo rr lb_kind DR # persistence_timeout 50 protocol TCP sorry_server 127.0.0.1 80 #定义sorry-server real_server 192.168.6.80 80 { weight 1 HTTP_GET { url { path / status_code 200 } connect_timeout 2 #连接超时时长 nb_get_retry 3 #超时重试数次 delay_before_retry 1 #每次重试时间间隔 } } real_server 192.168.6.82 80 { weight 1 HTTP_GET { url { path / status_code 200 } connect_timeout 2 nb_get_retry 3 delay_before_retry 1 } } } 3.realsrv[1,2]运行配置脚本 ~# sh lvs_dr_rs.sh start vi lvs_dr_rs.sh #!/bin/bash #Author:wangxiaochun #Date:2017-08-13 vip=192.168.6.99 mask=&apos;255.255.255.255&apos; dev=lo:1 rpm -q httpd &amp;&gt; /dev/null || yum -y install httpd &amp;&gt;/dev/null service httpd start &amp;&gt; /dev/null &amp;&amp; echo &quot;The httpd Server is Ready!&quot; echo &quot;&lt;h1&gt;`hostname`&lt;/h1&gt;&quot; &gt; /var/www/html/index.html case $1 in start) echo 1 &gt; /proc/sys/net/ipv4/conf/all/arp_ignore echo 1 &gt; /proc/sys/net/ipv4/conf/lo/arp_ignore echo 2 &gt; /proc/sys/net/ipv4/conf/all/arp_announce echo 2 &gt; /proc/sys/net/ipv4/conf/lo/arp_announce ifconfig $dev $vip netmask $mask #broadcast $vip up #route add -host $vip dev $dev echo &quot;The RS Server is Ready!&quot; ;; stop) ifconfig $dev down echo 0 &gt; /proc/sys/net/ipv4/conf/all/arp_ignore echo 0 &gt; /proc/sys/net/ipv4/conf/lo/arp_ignore echo 0 &gt; /proc/sys/net/ipv4/conf/all/arp_announce echo 0 &gt; /proc/sys/net/ipv4/conf/lo/arp_announce echo &quot;The RS Server is Canceled!&quot; ;; *) echo &quot;Usage: $(basename $0) start|stop&quot; exit 1 ;; esac 4.配置sorry-server nodesrv[1,2] yum install httpd -y echo &apos;sorry server nodesrv[1,2]&apos; &gt;/www/html/index.html systemctl start httpd 5.cleint测试集群环境,注意防火墙规则 ~# while true; do curl 192.168.6.99; sleep 1; done]]></content>
      <tags>
        <tag>keepalived</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Markdown简单用法]]></title>
    <url>%2F2018%2F12%2F24%2FMarkdown%E7%AE%80%E5%8D%95%E7%94%A8%E6%B3%95%2F</url>
    <content type="text"><![CDATA[Markdown基本语法 markdown是一种纯文本格式的标记语言。通过简单的标记语法,它可以使普通文本内容具有一定的格式. 标题 # 这是一级标题 ## 这是二级标题 ### 这是三级标题 #### 这是四级标题 ##### 这是五级标题 ###### 这是六级标题 字体 斜体 要倾斜的文字左右分别用一个*号包起来 *这是倾斜的文字* 加粗 要加粗的文字左右分别用两个*号包起来 **这是加粗的文字** 斜体加粗 要倾斜和加粗的文字左右分别用三个*号包起来 ***这是斜体加粗的文字*** 删除线 要加删除线的文字左右分别用两个~~号包起来 ~~这是加删除线的文字~~ 分割线 三个或者三个以上的 - 或者 * 都可以 --- ---- *** ***** 超链接 [超链接名](超链接地址 &quot;超链接title&quot;) title可加可不加 [百度](http://baidu.com) 列表 无序列表 语法:无序列表用 - + * 任何一种都可以 - 列表内容 + 列表内容 * 列表内容 注意:- + * 跟内容之间都要有一个空格 有序列表 语法:数字加点 1.列表内容 2.列表内容 3.列表内容 注意：序号跟内容之间要有空格 列表嵌套 上一级和下一级之间敲三个空格即可 代码 单行代码:代码之间分别用一个反引号包起来 `代码内容` 代码块:代码之间分别用三个反引号包起来,且两边的反引号单独占一行 (```) 代码... 代码... 代码... (```) 注意:为了防止转译,前后三个反引号处加了小括号,实际是没有的.这里只是用来演示,实际中去掉两边小括号即可.]]></content>
      <tags>
        <tag>markdown</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello Word]]></title>
    <url>%2F2018%2F12%2F23%2FHello%20Word%2F</url>
    <content type="text"><![CDATA[前言安之若素，冷暖自知； 阳光很好， 我亦很好。]]></content>
      <tags>
        <tag>Test</tag>
      </tags>
  </entry>
</search>
